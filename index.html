<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å —Å—Ç—Ä–∏–º–µ—Ä–∞</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- UIkit CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.23.10/dist/css/uikit.min.css"  />

  <style>
    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #f8f8f8;
      margin: 0;
      padding: 0;
    }

    .container {
      width: 100%;
      max-width: 600px;
      padding: 20px;
    }

    .admin-panel {
      text-align: left;
    }
  </style>
</head>
<body>

  <div class="container" id="mainContent">
    <div class="uk-card uk-card-default uk-card-body">
      <h1 class="uk-heading-small uk-text-center">–ü–æ–¥–¥–µ—Ä–∂–∏—Ç–µ –º–æ–π —Å—Ç—Ä–∏–º ‚ù§Ô∏è</h1>

      <form id="donateForm" class="uk-form-stacked">
        <div class="uk-margin">
          <label class="uk-form-label" for="amount">–°—É–º–º–∞:</label>
          <div class="uk-form-controls">
            <input class="uk-input" id="amount" type="number" min="1" step="0.01" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É" required>
          </div>
        </div>

        <div class="uk-margin uk-text-center">
          <button class="uk-button uk-button-primary" type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–æ–Ω–∞—Ç</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Admin Panel -->
  <div class="container admin-panel" id="adminPanel" style="display: none;">
    <div class="uk-card uk-card-default uk-card-body">
      <h1 class="uk-heading-medium uk-text-center">üîß –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>

      <ul uk-tab>
        <li><a href="#">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a></li>
        <li><a href="#">–õ–æ–≥–∏</a></li>
        <li><a href="#">–û–≤–µ—Ä–ª–µ–π</a></li>
      </ul>

      <ul class="uk-switcher uk-margin">
        <!-- YooKassa Settings -->
        <li>
          <div class="uk-form-stacked">
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ YooKassa</h3>
            <div class="uk-margin">
              <label class="uk-form-label" for="accountId">Merchant Account ID</label>
              <div class="uk-form-controls">
                <input class="uk-input" id="accountId" type="text" placeholder="–í–∞—à Merchant ID">
              </div>
            </div>
            <div class="uk-margin">
              <label class="uk-form-label" for="secretKey">Secret Key</label>
              <div class="uk-form-controls">
                <input class="uk-input" id="secretKey" type="password" placeholder="–í–∞—à Secret Key">
              </div>
            </div>
            <button class="uk-button uk-button-default" onclick="saveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          </div>
        </li>

        <!-- Logs -->
        <li>
          <h3>–õ–æ–≥–∏ –¥–æ–Ω–∞—Ç–æ–≤</h3>
          <pre id="logOutput" class="uk-text-small" style="max-height: 400px; overflow: auto;">
[LOG] –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!
          </pre>
          <button class="uk-button uk-button-default uk-margin-top" onclick="copyLogs()">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏</button>
        </li>

        <!-- Overlay -->
        <li>
          <h3>–û–≤–µ—Ä–ª–µ–π –¥–ª—è OBS</h3>
          <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç URL –≤ OBS –∫–∞–∫ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫:</p>
          <code class="uk-badge uk-width-1-1 uk-text-break">https://TOWUK.github.io/overlay.html</code> 
        </li>
      </ul>

      <div class="uk-margin-top uk-text-center">
        <button onclick="goBack()" class="uk-button uk-button-secondary">‚¨Ö –ù–∞–∑–∞–¥ –Ω–∞ –≥–ª–∞–≤–Ω—É—é</button>
      </div>
    </div>
  </div>

  <!-- UIkit JS -->
  <script src="https://cdn.jsdelivr.net/npm/uikit@3.23.10/dist/js/uikit.min.js"></script> 
  <script src="https://cdn.jsdelivr.net/npm/uikit@3.23.10/dist/js/uikit-icons.min.js"></script> 

  <!-- YooKassa SDK -->
  <script src="https://yookassa.ru/checkout-widget/v1/yookassa-checkout-widget.js"></script> 

  <script>
    // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let accountId = '';
    let secretKey = '';

    // Ctrl+A ‚Üí admin1
    document.addEventListener('keydown', function(e) {
      if (e.key === 'a' && e.ctrlKey) {
        let pass = prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω–∫–µ:");
        if (pass === "admin1") {
          document.getElementById('mainContent').style.display = 'none';
          document.getElementById('adminPanel').style.display = 'block';
        }
      }
    });

    function goBack() {
      document.getElementById('adminPanel').style.display = 'none';
      document.getElementById('mainContent').style.display = 'block';
    }

    function saveSettings() {
      accountId = document.getElementById('accountId').value;
      secretKey = document.getElementById('secretKey').value;
      alert("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!");
    }

    function copyLogs() {
      const logs = document.getElementById('logOutput').innerText;
      navigator.clipboard.writeText(logs).then(() => {
        alert("–õ–æ–≥–∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã!");
      });
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –¥–æ–Ω–∞—Ç–∞
    document.getElementById('donateForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const amount = document.getElementById('amount').value;

      if (!accountId || !secretKey) {
        alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ YooKassa –≤ –∞–¥–º–∏–Ω–∫–µ!");
        return;
      }

      const checkout = new window.YooMoneyCheckoutWidget({
        shopId: accountId,
        widgetSize: 'm',
        scid: 123456, // –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
        sum: amount,
        customerEmail: '', // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
        paymentType: 'ac', // –ª—é–±–∞—è —Ñ–æ—Ä–º–∞ –æ–ø–ª–∞—Ç—ã

        onSuccess: function (payment) {
          console.log("–ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–µ–Ω", payment);
          logDonation(`üéâ ${payment.email || '–ê–Ω–æ–Ω–∏–º'} –æ—Ç–ø—Ä–∞–≤–∏–ª ${payment.amount.value}‚ÇΩ`);
          notifyOverlay({ name: payment.email || '–ê–Ω–æ–Ω–∏–º', amount: payment.amount.value });
        },

        onFail: function (err) {
          console.error("–û—à–∏–±–∫–∞ –ø–ª–∞—Ç–µ–∂–∞", err);
          alert("–û—à–∏–±–∫–∞ –ø–ª–∞—Ç–µ–∂–∞");
        }
      });

      checkout.render('donateForm');
    });

    function logDonation(message) {
      const timestamp = new Date().toLocaleTimeString();
      const logEntry = `[${timestamp}] ${message}`;
      const logBox = document.getElementById('logOutput');
      logBox.innerText += '\n' + logEntry;
    }

    function notifyOverlay(data) {
      localStorage.setItem('last_donation', JSON.stringify(data));
    }
  </script>
</body>
</html>
